webpackJsonp([7],{"2B2B":function(e,a,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.button_submit {\n  text-align: center;\n}\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #20a0ff;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n}\n.avatar {\n  width: 120px;\n  height: 120px;\n  display: block;\n}\n.el-table {\n  border: 1px solid #dfe6ec;\n  border-bottom: none;\n}\n.el-table th {\n  background-color: #eef1f6;\n}\n.el-table .info-row {\n  background: #c9e5f5;\n}\n.el-table .positive-row {\n  background: #e2f0e4;\n}\n",""])},EaYx:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("woOf"),o=t.n(r),n=t("Xxa5"),i=t.n(n),s=t("exGp"),l=t.n(s),c=t("bBUo"),m=t("1h8J"),u=t("uaSg"),p={data:function(){return{city:{id:"44",name:"重庆"},formData:{name:"",address:"",latitude:"",longitude:"",description:"",phone:"",promotion_info:"",float_delivery_fee:5,float_minimum_order_amount:20,is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话"},{type:"number",message:"电话号码必须是数字"}]},options:[{value:"满减优惠",label:"满减优惠"},{value:"优惠大酬宾",label:"优惠大酬宾"},{value:"新用户立减",label:"新用户立减"},{value:"进店领券",label:"进店领券"}],activityValue:"满减优惠",activities:[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}],baseUrl:u.b,baseImgPath:u.a,categoryOptions:[],selectedCategory:["快餐便当","简餐"]}},components:{headTop:c.a},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return l()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(m.i)();case 3:(t=a.sent).forEach(function(a){if(a.sub_categories.length){var t={value:a.name,label:a.name,children:[]};a.sub_categories.forEach(function(e,a){0!=a&&t.children.push({value:e.name,label:e.name})}),e.categoryOptions.push(t)}}),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}},a,e,[[0,7]])}))()},querySearchAsync:function(e,a){var t=this;return l()(i.a.mark(function r(){var o;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=11;break}return r.prev=1,r.next=4,Object(m.B)(t.city.id,e);case 4:(o=r.sent)instanceof Array&&(o.forEach(function(e){return e.value=e.address,e}),a(o)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),console.log(r.t0);case 11:case"end":return r.stop()}},r,t,[[1,8]])}))()},addressSelect:function(e){this.formData.latitude=e.latitude,this.formData.longitude=e.longitude,console.log(this.formData.latitude,this.formData.longitude,"name:"+e.name)},handleShopAvatarScucess:function(e,a){1==e.status?this.formData.image_path=URL.createObjectURL(a.raw):this.$message.error("上传图片失败！")},handleBusinessAvatarScucess:function(e,a){1==e.status?this.formData.business_license_image=URL.createObjectURL(a.raw):this.$message.error("上传图片失败！")},handleServiceAvatarScucess:function(e,a){1==e.status?this.formData.catering_service_license_image=URL.createObjectURL(a.raw):this.$message.error("上传图片失败！")},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},tableRowClassName:function(e,a){return 1===a?"info-row":3===a?"positive-row":""},selectActivity:function(){var e=this;this.$prompt("请输入活动详情","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var t=a.value;if(null!=t){var r={};switch(e.activityValue){case"满减优惠":r={icon_name:"减",name:"满减优惠",description:t};break;case"优惠大酬宾":r={icon_name:"特",name:"优惠大酬宾",description:t};break;case"新用户立减":r={icon_name:"新",name:"新用户立减",description:t};break;case"进店领券":r={icon_name:"领",name:"进店领券",description:t}}e.activities.push(r)}else e.$message({type:"info",message:"请输入活动详情"})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},handleDelete:function(e){this.activities.splice(e,1)},submitForm:function(e){var a=this;this.$refs[e].validate(function(){var e=l()(i.a.mark(function e(t){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=15;break}return o()(a.formData,{activities:a.activities},{category:a.selectedCategory.join("/")}),e.prev=2,e.next=5,Object(m.c)(a.formData);case 5:1==(r=e.sent).status?(a.$message({type:"success",message:"添加成功"}),a.formData={name:"",address:"",latitude:"",longitude:"",description:"",phone:"",promotion_info:"",float_delivery_fee:5,float_minimum_order_amount:20,is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:""},a.selectedCategory=["快餐便当","简餐"],a.activities=[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}]):a.$message({type:"error",message:r.message}),console.log(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:e.next=17;break;case 15:return a.$notify.error({title:"错误",message:"请检查输入是否正确",offset:100}),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,a,[[2,10]])}));return function(a){return e.apply(this,arguments)}}())}}},f={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("head-top"),e._v(" "),t("el-row",{staticStyle:{"margin-top":"20px"}},[t("el-col",{attrs:{span:12,offset:3}},[t("el-form",{ref:"formData",staticClass:"demo-formData",attrs:{model:e.formData,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[t("el-input",{model:{value:e.formData.name,callback:function(a){e.$set(e.formData,"name",a)},expression:"formData.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入地址"},on:{select:e.addressSelect},model:{value:e.formData.address,callback:function(a){e.$set(e.formData,"address",a)},expression:"formData.address"}}),e._v(" "),t("span",[e._v("当前城市："+e._s(e.city.name))])],1),e._v(" "),t("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[t("el-input",{attrs:{maxLength:"11"},model:{value:e.formData.phone,callback:function(a){e.$set(e.formData,"phone",e._n(a))},expression:"formData.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺简介",prop:"description"}},[t("el-input",{model:{value:e.formData.description,callback:function(a){e.$set(e.formData,"description",a)},expression:"formData.description"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺标语",prop:"promotion_info"}},[t("el-input",{model:{value:e.formData.promotion_info,callback:function(a){e.$set(e.formData,"promotion_info",a)},expression:"formData.promotion_info"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺标语",prop:"promotion_info"}},[t("el-input",{model:{value:e.formData.promotion_info,callback:function(a){e.$set(e.formData,"promotion_info",a)},expression:"formData.promotion_info"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺分类"}},[t("el-cascader",{attrs:{options:e.categoryOptions,"change-on-select":""},model:{value:e.selectedCategory,callback:function(a){e.selectedCategory=a},expression:"selectedCategory"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"},attrs:{label:"店铺特点"}},[t("span",[e._v("品牌保证")]),e._v(" "),t("el-switch",{model:{value:e.formData.is_premium,callback:function(a){e.$set(e.formData,"is_premium",a)},expression:"formData.is_premium"}}),e._v(" "),t("span",[e._v("蜂鸟专送")]),e._v(" "),t("el-switch",{model:{value:e.formData.delivery_mode,callback:function(a){e.$set(e.formData,"delivery_mode",a)},expression:"formData.delivery_mode"}}),e._v(" "),t("span",[e._v("新开店铺")]),e._v(" "),t("el-switch",{model:{value:e.formData.new,callback:function(a){e.$set(e.formData,"new",a)},expression:"formData.new"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"}},[t("span",[e._v("外卖保")]),e._v(" "),t("el-switch",{model:{value:e.formData.bao,callback:function(a){e.$set(e.formData,"bao",a)},expression:"formData.bao"}}),e._v(" "),t("span",[e._v("准时达")]),e._v(" "),t("el-switch",{model:{value:e.formData.zhun,callback:function(a){e.$set(e.formData,"zhun",a)},expression:"formData.zhun"}}),e._v(" "),t("span",[e._v("开发票")]),e._v(" "),t("el-switch",{model:{value:e.formData.piao,callback:function(a){e.$set(e.formData,"piao",a)},expression:"formData.piao"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"配送费",prop:"float_delivery_fee"}},[t("el-input-number",{attrs:{min:0,max:20},model:{value:e.formData.float_delivery_fee,callback:function(a){e.$set(e.formData,"float_delivery_fee",a)},expression:"formData.float_delivery_fee"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"起送价",prop:"float_minimum_order_amount"}},[t("el-input-number",{attrs:{min:0,max:100},model:{value:e.formData.float_minimum_order_amount,callback:function(a){e.$set(e.formData,"float_minimum_order_amount",a)},expression:"formData.float_minimum_order_amount"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"},attrs:{label:"营业时间"}},[t("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"05:30",step:"00:15",end:"23:30"}},model:{value:e.formData.startTime,callback:function(a){e.$set(e.formData,"startTime",a)},expression:"formData.startTime"}}),e._v(" "),t("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"05:30",step:"00:15",end:"23:30",minTime:e.formData.startTime}},model:{value:e.formData.endTime,callback:function(a){e.$set(e.formData,"endTime",a)},expression:"formData.endTime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"上传店铺头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"apis/v1/addimg/shop","show-file-list":!1,"on-success":e.handleShopAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.image_path?t("img",{staticClass:"avatar",attrs:{src:e.formData.image_path}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传营业执照"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"apis/v1/addimg/shop","show-file-list":!1,"on-success":e.handleBusinessAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.business_license_image?t("img",{staticClass:"avatar",attrs:{src:e.formData.business_license_image}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传餐饮服务许可证"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"apis/v1/addimg/shop","show-file-list":!1,"on-success":e.handleServiceAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.catering_service_license_image?t("img",{staticClass:"avatar",attrs:{src:e.formData.catering_service_license_image}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"优惠活动"}},[t("el-select",{attrs:{placeholder:e.activityValue},on:{change:e.selectActivity},model:{value:e.activityValue,callback:function(a){e.activityValue=a},expression:"activityValue"}},e._l(e.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-table",{staticStyle:{"min-width":"600px","margin-bottom":"20px"},attrs:{data:e.activities,align:"cneter","row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{prop:"icon_name",label:"活动标题",align:"cneter",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"name",label:"活动名称",align:"cneter",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"description",align:"cneter",label:"活动详情"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){e.handleDelete(a.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.submitForm("formData")}}},[e._v("立即创建")])],1)],1)],1)],1)],1)},staticRenderFns:[]},d=t("VU/8")(p,f,!1,function(e){t("ILCR")},null,null);a.default=d.exports},ILCR:function(e,a,t){var r=t("2B2B");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("5f9fc8e0",r,!0)}});